---
title: Spring 의존객체 자동주입
author: jinow
cover: "/assets/posts/1.jpg"
categories: Spring
layout: post
date: '2018-11-23 23:18:25'
---

지난 시간에 Spring DI에 대해 다루었고, 스프링 컨테이너 안에서 어떠한 방식으로 의존성 주입이 동작하는지 살펴보았다.  
이번 시간에는 **어노테이션**을 통하여 컨테이너 안에서 의존객체를 자동으로 주입하는 방식에 대해 알아보도록 하겠다.

### 1.1 @Autowired를 통한 자동 주입
@Autowired는 주입하려고 하는 객체의 **타입**이 일치하는 객체를 자동으로 주입한다.  
지난시간에 실습하였던 constructorToy와 setterToy 빈 객체를 다시 한번 사용하도록 하겠다. 기억이 안나는 분들은 이전 post를 다시 한번 살펴보도록 한다.  

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
 		http://www.springframework.org/schema/beans/spring-beans.xsd
 		http://www.springframework.org/schema/context
 		http://www.springframework.org/schema/context/spring-context.xsd">

	<context:annotation-config />

	<bean id = "batteryA" class = "di.BatteryA" />

	<bean id = "constructorToy" class = "di.annotation.ElectronicToy" />
	<bean id = "setterToy" class = "di.annotation.ElectronicToy" />


</beans>
```
1. context 스키마 추가
2. ```<context:annotation-config />``` 추가
3. ```<constructor-arg>```,```<property>``` 로 명시되어 있던 배터리 객체 삭제

```
package di.annotation;

import org.springframework.beans.factory.annotation.Autowired;

import di.*;

public class ElectronicToy {
	@Autowired
	private Battery battery;

	public ElectronicToy() {
		System.out.println("toy 생성 ");
	}
	//생성자를 통한 의존성 주입
	@Autowired
	public ElectronicToy(Battery battery) {
		this();
		System.out.println("생성자를 통한 의존성 주입" );
		this.battery = battery;
	}

	//setter를 통한 의존성 주입
	@Autowired
	public void setBattery(Battery battery) {
		System.out.println("setter함수를 통한 의존성 주입" );
		this.battery = battery;
	}

	//장난감이 장착한 배터리의 스팩을 보여준다.
	public void showBatterySpec() {
		System.out.println("battery name : " + battery.getName());
		System.out.println("battery capacity : " + battery.getCapacity());
	}

}
```
1. 생성자 주입 : 생성자 함수에 @Autowired 추가
2. setter 주입 : 속성, 및 setter 함수에 @Autowired 추가
실행시켰을때 이전 포스트의 결과와 동일함을 확인할 수 있다.

### 1.2 @Resource 를 통한 자동주입
@Resource는 주입하려고 하는 객체의 **이름**이 일치하는 객체를 자동으로 주입한다.
```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
 		http://www.springframework.org/schema/beans/spring-beans.xsd
 		http://www.springframework.org/schema/context
 		http://www.springframework.org/schema/context/spring-context.xsd">

	<context:annotation-config />

	<bean id = "batterB" class = "di.BatteryB" />
	<bean id = "setterToy" class = "di.annotation.ElectronicToy" />


</beans>
```
@Resource 는 setter 주입에만 사용이 가능하기 떄문에, setterToy만 남겨두고 주입할 베터리는 batteryB를 선택하였다.

```
package di.annotation;

import javax.annotation.Resource;

import org.springframework.beans.factory.annotation.Autowired;

import di.*;

public class ElectronicToy {

	@Resource
	private Battery batteryB;

	public ElectronicToy() {
		System.out.println("toy 생성 ");
	}
	//생성자를 통한 의존성 주입
	public ElectronicToy(Battery battery) {
		this();
		System.out.println("생성자를 통한 의존성 주입" );
		this.batteryB = battery;
	}

	//setter를 통한 의존성 주입
	@Resource
	public void setBattery(Battery battery) {
		System.out.println("setter함수를 통한 의존성 주입" );
		this.batteryB = battery;
	}

	//장난감이 장착한 배터리의 스팩을 보여준다.
	public void showBatterySpec() {
		System.out.println("battery name : " + batteryB.getName());
		System.out.println("battery capacity : " + batteryB.getCapacity());
	}

}
```
1. 속성과 setter 메서드에 @Resource 어노테이션을 추가하였다.
2. battery변수의 이름을 설정파일에 있는 batteryB 와 일치시켰다.

```
package di.annotation;

import org.springframework.context.support.GenericXmlApplicationContext;

public class ToyCreateExam {
	public static void main(String[] args) {
		//컨테이너 생성  
		//컨테이너 리소스를 불러온다
		GenericXmlApplicationContext ctx =
			new GenericXmlApplicationContext("classpath:applicationContextUseAutowired.xml");

		System.out.println("-------객체 호출 --------");

		//setterToy bean 객체를 호출
		ElectronicToy strToy1 = ctx.getBean("setterToy", ElectronicToy.class);

	}
}
```
```
Nov 27, 2018 8:18:25 AM org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions
정보: Loading XML bean definitions from class path resource [applicationContextUseAutowired.xml]
Nov 27, 2018 8:18:25 AM org.springframework.context.support.GenericXmlApplicationContext prepareRefresh
정보: Refreshing org.springframework.context.support.GenericXmlApplicationContext@2dda6444: startup date [Tue Nov 27 08:18:25 KST 2018]; root of context hierarchy
battery 객체생성
toy 생성
setter함수를 통한 의존성 주입
-------객체 호출 --------
```
다음과 같이 컨테이너 리소스를 불러왔을때 setterToy 객체가 생성되었고 setter함수를 통한 의존성 주입이 실행됨을 확인할 수 있다.


### 정리
* Autowired : 생성자, 프로퍼티 어디서나 사용 가능, 객체의 타입을 보고 찾아냄
* Resource : 프로퍼티에서만 사용가능, 객체의 이름을 보고 찾아냄
